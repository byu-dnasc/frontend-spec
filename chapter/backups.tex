%  Chapter: Backups page

\section{Overview}

\vspace{3mm}
\emph{``The cloud is just someone else's computer.'' -Anonymous}
\vspace{3mm}

\noindent This chapter will describe the contents of the backup pop-up window.
This pop-up will facilitate the backing up of sequencing data files generated 
in the DNASC. It is opened by clicking the cell in the ``Backup'' column of the 
Movies table for a given movie. The pop-up window should allow the user initiate 
the copying of the primary files associated with the given movie to a backup device 
selected by the user. The pop-up window should also allow the user to register a new 
backup device.

\subsection{Backup workflow}
Movie files are initially stored on systems administered by the BYU Office of 
Research Computing (ORC). An essential task for DNASC technicians is to copy primary 
movie files from ORC storage to local hard drives. Once backed up, the files can be 
removed from ORC storage to free up space.

\section{Contents}

The contents of the backups pop-up window can be partitioned into three subsections: 
``Movie Details'', ``Backup Details'', and ``Create Backup''. The pop-up window should 
display all three subsections in a single listing in the order listed above, including 
the subsection name (formatted as a title) and contents. The contents of each subsection 
are described below. Note that this configuration allows for the case where, if some 
reason a backup has been lost, the option to create a new backup is still available.

\subsection{Movie Details}

The movie details subsection consists of the following items:
\begin{itemize}\itemsep1pt
  \item Movie id
  \item Sample name
  \item File size
\end{itemize}

\subsection{Backup Details}

The contents of the backup details subsection should should vary depending on 
whether or not the movie has been backed up before. If the movie has not been 
backed up before, the backup details subsection should consist of the following
string: 

\vspace{3mm}
``No backups have been created for this movie.''
\vspace{3mm}

\noindent If the movie has been backed up before, the Backup Details subsection
should consist of the following name-value pairs:

\begin{itemize}\itemsep1pt
  \item ``Backup Device'' and the value of movie property \texttt{backup\_device}
  \item ``Backup Date'' and the value of movie property \texttt{backup\_date}
\end{itemize}

\subsection{Create Backup}

The create backup subsection allows the user to initiate the backup process for
the given movie. The subsection should consist of the following items:

\begin{itemize}\itemsep1pt
  \item A selection menu of registered GCP endpoints, labeled ``Endpoint''
  \item A selection menu of backup devices available on the selected endpoint, labeled
  ``Backup Device''
  \item A button labeled ``Initiate Transfer''
  \item A button labeled ``Register Backup Device''
\end{itemize}

\subsubsection{Element availability} 

Due to dependencies between the elements in the create backup subsection, some elements
should (or can) not be made available until certain conditions are met. All elements 
should be visible at all times, but some elements should be disabled initially. The 
conditions under which an element should be enabled are as follows:

\begin{itemize}\itemsep1pt
  \item The ``Endpoint'' selection menu is enabled at all times
  % PICK UP HERE
  \item A selection menu of backup devices available on the selected endpoint, labeled
  ``Backup Device''
  \item A button labeled ``Initiate Transfer''
  \item A button labeled ``Register Backup Device''
\end{itemize}


The initiate transfer button should not be enabled until a backup device 
has been selected from the dropdown menu. The register backup device button should 
open the register backup device pop-up window described in chapter 
\ref{chapter:registerbackupdevice}.

\section{Actions}

\subsection{Create Backup}

The create backup action is used to copy a given movie to a backup device on a Globus
endpoint. The action is initiated by clicking the ``Create Backup'' button available 
in each row of the ``Awaiting Backup'' table. The button opens a pop-up window to
allow the user to select an endpoint and a backup device available on the endpoint 
to use for the transfer.

\subsubsection{Implementation}

% too detailed. put this paragraph somewhere else
When the ``Create Backup'' action is initiated, two lists should be created to populate
the dropdown menus in the pop-up window. The first list should contain all endpoints
which have been used before. If the user has not used any endpoints before, the list
should be empty. The second list should contain all backup devices available on the
selected endpoint. The frontend will use the Globus Transfer API to 
\href{appendix:identifybackupdevices}{identify all backup devices} available on the 
user-selected endpoint.

The user can select an endpoint and a backup device from the respective dropdown menus.
Once this is accomplished, the transfer can be submitted.
