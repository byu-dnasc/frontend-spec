% Chapter: Movies page

\section{Overview}

A new page will be created to display information about movies. The page will
have a table of movies and a few actions to perform on movies. The page will
also have a few pop-up windows to display more information about movies.

\noindent The page will consist of a single table.

\section{Movies Table}
Each row in the movie table will have a column for each of the following properties 
belonging to the movie object. Rows of movie data should be sorted by date. The 
cells of some columns serve as buttons to open a pop-up window.

\begin{table}[h]
    \input{table/movie_table_details.tex}
    \caption{Movies table}
\end{table}

\section{Pop-up windows}

\subsection{Movies on run run\_id}
List of movies that ran on run \texttt{run\_id}. Rows should be the same as in the main 
Movies table. This functionality could also be implemented by a filter being applied 
to the main Movies table.

\subsection{Sharing of movie movie\_id}
List of users who have been granted access to this movie. Rows should contain the 
same fields as those in the main Users table. First, get an 
\hyperref[section:updatingcollectionaccessrules]{up-to-date list of access rules} 
to determine which users have access to this movie. Then, use this information 
to filter out the appropriate \texttt{user} records.

\subsection{View movie directory}

Provide a link to open the Globus web app. See \linkglobusbrowseendpoint{link}.

\subsection{Analyses associated with movie movie\_id}

A pop-up window displaying a table of all analyses associated with the movie. An analysis 
is a dataset derived from primary movie data.

\begin{table}[h]
    \input{table/analysis_table_details.tex}
    \caption{Analysis Pop-up View}
\end{table}

\section{Actions}

Each of these actions is initiated with respect to a user-specified movie. I am open for 
suggestions on exactly how to present these actions to the user. One thing to consider is 
that a given action is only applicable given the right conditions.

\begin{table}[h]
    \input{table/movie_action_availabilities.tex}
    \caption{Movie action availability}
\end{table}

\subsection{Share}

The share action is used to grant a given DNASC customer access to a movie. To accomplish 
this, post an access rule object to \texttt{/endpoint/endpoint\_xid/access}. The access rule 
needs to include the following:

\begin{itemize}
    \item \texttt{user.globus\_id}
    \item \texttt{movie.sample\_name}
\end{itemize}

This rule will grant the user access to the primary movie data. From there, the backend will 
create additional access rules so that the user can access any analyses associated with the 
movie.

\emph{Will the user receive an automated message from Globus?}

\subsection{Download}

The download action is used to copy a given movie to a Globus endpoint specified by the user.
The user must provide the following info to submit a download task:

\begin{itemize}\itemsep1pt
    \item Movie
    \item Destination endpoint id
    \item (optional) destination path
\end{itemize}

\noindent With this information, the frontend can submit a transfer task to Globus.

\subsection{Upload}

\subsection{Unshare}
